---
title: 数模总结
tags:
  - 数模
categories:
  - 数模
mathjax: true
abbrlink: 528198f4
date: 2024-01-21 22:21:02
description:
---
# 数据处理

## 遍历每一个文件夹
### 把处理后的数据放在原文件夹
```python
import os

# 创建一个空的DataFrame，用于存储所有txt文件的数据
final_df = pd.DataFrame()

# 指定包含txt文件的文件夹路径
txt_folder = 'data/参考数据集/'

# 遍历文件夹中的每个txt文件

for subdir in range(1,11):
    subpath = os.path.join(txt_folder,str(subdir))
    for filename in os.listdir(subpath):
        if filename.endswith('.txt'):
            txt_file_path = os.path.join(subpath,filename)
            data_np = np.loadtxt(txt_file_path)
            data_np = data_np.T
            data_df = pd.DataFrame(data_np)
            data_df.to_excel(txt_file_path.replace('.txt', '.xlsx'), index=False)
print("数据已导入到Excel文件")
```
### 把数据按照原逻辑放在一个新文件夹
```python
import os
import numpy as np
import pandas as pd

# 指定基础文件夹路径
base_folder = 'data/参考数据集/'

# 创建一个新的文件夹用于存放处理后的Excel文件
clean_folder = 'data/clean/参考数据集/'
if not os.path.exists(clean_folder):
    os.makedirs(clean_folder)

# 遍历基础文件夹中的子文件夹
for subdir in os.listdir(base_folder):
    subdir_path = os.path.join(base_folder, subdir)
    if os.path.isdir(subdir_path):
        # 创建一个新的子文件夹用于存放处理后的Excel文件
        new_subfolder = os.path.join(clean_folder, subdir)
        if not os.path.exists(new_subfolder):
            os.makedirs(new_subfolder)

        # 遍历当前子文件夹中的txt文件
        for filename in os.listdir(subdir_path):
            if filename.endswith('.txt'):
                txt_file_path = os.path.join(subdir_path, filename)
                data_np = np.loadtxt(txt_file_path)
                data_np = data_np.T
                data_df = pd.DataFrame(data_np)

                # 生成新的Excel文件路径，存放在新的子文件夹中
                new_excel_path = os.path.join(new_subfolder, filename.replace('.txt', 'A_new.xlsx'))

                # 将DataFrame保存为Excel文件
                data_df.to_excel(new_excel_path, sheet_name='A', index=False)

print("数据已导入到Excel文件，并按照原文件夹逻辑存放在新的文件夹中")

```


# 画图
## 配色
### 单线
| 颜色 | 线      | 填充    |
| ---- | ------- | ------- |
| 橙   | #F0CC53 | #FFC66B |

### 两线

| 颜色 |         |         |
| ---- | ------- | ------- |
| 橙   | #F0CC53 | #F0CC53 |
### 三线

| 颜色 |         |         |         |
| ---- | ------- | ------- | ------- |
| 橙   | #F0CC53 | #00C9EF | #00C9EF |

## 模板
### 基本配置
```python

# 基础设置
# 设置全局字体为Times New Roman
plt.rcParams['font.family'] = 'Times New Roman'
# 设置字号为12pt
plt.rcParams['font.size'] = 12
# 清晰
%config InlineBackend.figure_format = 'retina'
%matplotlib inline
```
### 线形图模板
```python
import matplotlib.ticker as ticker
colors=['#F0CC53','#FF63A9']
population = population[::-1]
fig ,ax= plt.subplots(figsize=(16,4))

ax.stackplot(population['年份'],population['乡村人口(万人)'],population['城镇人口(万人)'],labels=['Rural Population','Urban Population'],colors=colors,alpha=0.6)

ax.plot(population['年份'],population['年末总人口(万人)'],'o',ls='-',color=colors[1],linewidth=3)

ax.plot(population['年份'],population['乡村人口(万人)'],'o',ls='-',color=colors[0],linewidth=3)

ax.set_ylabel('population ($1 \\times 10^4$)',weight='bold')
ax.legend(loc='upper left')
ax.set_xlabel('Year',weight='bold')
ax.grid()
ax.set_ylim(0,200000)
ax.xaxis.set_major_locator(ticker.MaxNLocator(integer=True))
ax.xaxis.set_major_locator(ticker.MultipleLocator(1))
```
### 堆叠图
```python
# 线形图样板图
# 第0维为线颜色,第1维为填充
colors = ['#F0CC53','#FFC66B']
fig,ax=plt.subplots(figsize=(15,3))

ax.plot(population['年份'],population['年末总人口(万人)'],'o',ls='-',color=colors[0],linewidth=3,label = 'population')

ax.legend(loc='upper left')
ax.fill_between(population['年份'],0,population['年末总人口(万人)'],color=colors[1],alpha=0.3)
ax.set_xlabel('Year',weight='bold')
ax.set_ylabel('population ($1 \\times 10^4$)',weight='bold')
ax.grid()
ax.set_ylim(120000,150000)
ax.xaxis.set_major_locator(ticker.MaxNLocator(integer=True))
ax.xaxis.set_major_locator(ticker.MultipleLocator(1))
```

